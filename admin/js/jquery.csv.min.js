RegExp.escape=function(a){return a.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")};(function(b){var a;if(typeof jQuery!=="undefined"&&jQuery){a=jQuery}else{a={}}a.csv={defaults:{separator:",",delimiter:'"',headers:true},hooks:{castToScalar:function(f,e){var c=/\./;if(isNaN(f)){return f}else{if(c.test(f)){return parseFloat(f)}else{var d=parseInt(f);if(isNaN(d)){return null}else{return d}}}}},parsers:{parse:function(h,q){var k=q.separator;var e=q.delimiter;if(!q.state.rowNum){q.state.rowNum=1}if(!q.state.colNum){q.state.colNum=1}var i=[];var n=[];var d=0;var m="";var f=false;function p(){d=0;m="";if(q.start&&q.state.rowNum<q.start){n=[];q.state.rowNum++;q.state.colNum=1;return}if(q.onParseEntry===b){i.push(n)}else{var r=q.onParseEntry(n,q.state);if(r!==false){i.push(r)}}n=[];if(q.end&&q.state.rowNum>=q.end){f=true}q.state.rowNum++;q.state.colNum=1}function o(){if(q.onParseValue===b){n.push(m)}else{var r=q.onParseValue(m,q.state);if(r!==false){n.push(r)}}m="";d=0;q.state.colNum++}var l=RegExp.escape(k);var g=RegExp.escape(e);var j=/(D|S|\r\n|\n|\r|[^DS\r\n]+)/;var c=j.source;c=c.replace(/S/g,l);c=c.replace(/D/g,g);j=new RegExp(c,"gm");h.replace(j,function(r){if(f){return}switch(d){case 0:if(r===k){m+="";o();break}if(r===e){d=1;break}if(/^(\r\n|\n|\r)$/.test(r)){o();p();break}m+=r;d=3;break;case 1:if(r===e){d=2;break}m+=r;d=1;break;case 2:if(r===e){m+=r;d=1;break}if(r===k){o();break}if(/^(\r\n|\n|\r)$/.test(r)){o();p();break}throw new Error("CSVDataError: Illegal State [Row:"+q.state.rowNum+"][Col:"+q.state.colNum+"]");case 3:if(r===k){o();break}if(/^(\r\n|\n|\r)$/.test(r)){o();p();break}if(r===e){throw new Error("CSVDataError: Illegal Quote [Row:"+q.state.rowNum+"][Col:"+q.state.colNum+"]")}throw new Error("CSVDataError: Illegal Data [Row:"+q.state.rowNum+"][Col:"+q.state.colNum+"]");default:throw new Error("CSVDataError: Unknown State [Row:"+q.state.rowNum+"][Col:"+q.state.colNum+"]")}});if(n.length!==0){o();p()}return i},splitLines:function(h,o){var j=o.separator;var e=o.delimiter;if(!o.state.rowNum){o.state.rowNum=1}var k=[];var d=0;var n="";var f=false;function m(){d=0;if(o.start&&o.state.rowNum<o.start){n="";o.state.rowNum++;return}if(o.onParseEntry===b){k.push(n)}else{var p=o.onParseEntry(n,o.state);if(p!==false){k.push(p)}}n="";if(o.end&&o.state.rowNum>=o.end){f=true}o.state.rowNum++}var l=RegExp.escape(j);var g=RegExp.escape(e);var i=/(D|S|\n|\r|[^DS\r\n]+)/;var c=i.source;c=c.replace(/S/g,l);c=c.replace(/D/g,g);i=new RegExp(c,"gm");h.replace(i,function(p){if(f){return}switch(d){case 0:if(p===j){n+=p;d=0;break}if(p===e){n+=p;d=1;break}if(p==="\n"){m();break}if(/^\r$/.test(p)){break}n+=p;d=3;break;case 1:if(p===e){n+=p;d=2;break}n+=p;d=1;break;case 2:var q=n.substr(n.length-1);if(p===e&&q===e){n+=p;d=1;break}if(p===j){n+=p;d=0;break}if(p==="\n"){m();break}if(p==="\r"){break}throw new Error("CSVDataError: Illegal state [Row:"+o.state.rowNum+"]");case 3:if(p===j){n+=p;d=0;break}if(p==="\n"){m();break}if(p==="\r"){break}if(p===e){throw new Error("CSVDataError: Illegal quote [Row:"+o.state.rowNum+"]")}throw new Error("CSVDataError: Illegal state [Row:"+o.state.rowNum+"]");default:throw new Error("CSVDataError: Unknown state [Row:"+o.state.rowNum+"]")}});if(n!==""){m()}return k},parseEntry:function(g,n){var i=n.separator;var e=n.delimiter;if(!n.state.rowNum){n.state.rowNum=1}if(!n.state.colNum){n.state.colNum=1}var l=[];var d=0;var k="";function m(){if(n.onParseValue===b){l.push(k)}else{var o=n.onParseValue(k,n.state);if(o!==false){l.push(o)}}k="";d=0;n.state.colNum++}if(!n.match){var j=RegExp.escape(i);var f=RegExp.escape(e);var h=/(D|S|\n|\r|[^DS\r\n]+)/;var c=h.source;c=c.replace(/S/g,j);c=c.replace(/D/g,f);n.match=new RegExp(c,"gm")}g.replace(n.match,function(o){switch(d){case 0:if(o===i){k+="";m();break}if(o===e){d=1;break}if(o==="\n"||o==="\r"){break}k+=o;d=3;break;case 1:if(o===e){d=2;break}k+=o;d=1;break;case 2:if(o===e){k+=o;d=1;break}if(o===i){m();break}if(o==="\n"||o==="\r"){break}throw new Error("CSVDataError: Illegal State [Row:"+n.state.rowNum+"][Col:"+n.state.colNum+"]");case 3:if(o===i){m();break}if(o==="\n"||o==="\r"){break}if(o===e){throw new Error("CSVDataError: Illegal Quote [Row:"+n.state.rowNum+"][Col:"+n.state.colNum+"]")}throw new Error("CSVDataError: Illegal Data [Row:"+n.state.rowNum+"][Col:"+n.state.colNum+"]");default:throw new Error("CSVDataError: Unknown State [Row:"+n.state.rowNum+"][Col:"+n.state.colNum+"]")}});m();return l}},helpers:{collectPropertyNames:function(e){var f,d,c=[];for(f in e){for(d in e[f]){if((e[f].hasOwnProperty(d))&&(c.indexOf(d)<0)&&(typeof e[f][d]!=="function")){c.push(d)}}}return c}},toArray:function(c,e,h){e=(e!==b?e:{});var d={};d.callback=((h!==b&&typeof(h)==="function")?h:false);d.separator="separator" in e?e.separator:a.csv.defaults.separator;d.delimiter="delimiter" in e?e.delimiter:a.csv.defaults.delimiter;var g=(e.state!==b?e.state:{});e={delimiter:d.delimiter,separator:d.separator,onParseEntry:e.onParseEntry,onParseValue:e.onParseValue,state:g};var f=a.csv.parsers.parseEntry(c,e);if(!d.callback){return f}else{d.callback("",f)}},toArrays:function(c,e,g){e=(e!==b?e:{});var d={};d.callback=((g!==b&&typeof(g)==="function")?g:false);d.separator="separator" in e?e.separator:a.csv.defaults.separator;d.delimiter="delimiter" in e?e.delimiter:a.csv.defaults.delimiter;var f=[];e={delimiter:d.delimiter,separator:d.separator,onPreParse:e.onPreParse,onParseEntry:e.onParseEntry,onParseValue:e.onParseValue,onPostParse:e.onPostParse,start:e.start,end:e.end,state:{rowNum:1,colNum:1}};if(e.onPreParse!==b){e.onPreParse(c,e.state)}f=a.csv.parsers.parse(c,e);if(e.onPostParse!==b){e.onPostParse(f,e.state)}if(!d.callback){return f}else{d.callback("",f)}},toObjects:function(h,q,p){q=(q!==b?q:{});var e={};e.callback=((p!==b&&typeof(p)==="function")?p:false);e.separator="separator" in q?q.separator:a.csv.defaults.separator;e.delimiter="delimiter" in q?q.delimiter:a.csv.defaults.delimiter;e.headers="headers" in q?q.headers:a.csv.defaults.headers;q.start="start" in q?q.start:1;if(e.headers){q.start++}if(q.end&&e.headers){q.end++}var r=[];var l=[];q={delimiter:e.delimiter,separator:e.separator,onPreParse:q.onPreParse,onParseEntry:q.onParseEntry,onParseValue:q.onParseValue,onPostParse:q.onPostParse,start:q.start,end:q.end,state:{rowNum:1,colNum:1},match:false,transform:q.transform};var c={delimiter:e.delimiter,separator:e.separator,start:1,end:1,state:{rowNum:1,colNum:1}};if(q.onPreParse!==b){q.onPreParse(h,q.state)}var n=a.csv.parsers.splitLines(h,c);var d=a.csv.toArray(n[0],q);r=a.csv.parsers.splitLines(h,q);q.state.colNum=1;if(d){q.state.rowNum=2}else{q.state.rowNum=1}for(var k=0,m=r.length;k<m;k++){var o=a.csv.toArray(r[k],q);var f={};for(var g=0;g<d.length;g++){f[d[g]]=o[g]}if(q.transform!==b){l.push(q.transform.call(b,f))}else{l.push(f)}q.state.rowNum++}if(q.onPostParse!==b){q.onPostParse(l,q.state)}if(!e.callback){return l}else{e.callback("",l)}},fromArrays:function(c,n,m){n=(n!==b?n:{});var d={};d.callback=((m!==b&&typeof(m)==="function")?m:false);d.separator="separator" in n?n.separator:a.csv.defaults.separator;d.delimiter="delimiter" in n?n.delimiter:a.csv.defaults.delimiter;var e="",o,l,g,f;for(g=0;g<c.length;g++){o=c[g];l=[];for(f=0;f<o.length;f++){var k=(o[f]===b||o[f]===null)?"":o[f].toString();if(k.indexOf(d.delimiter)>-1){k=k.replace(d.delimiter,d.delimiter+d.delimiter)}var h="\n|\r|S|D";h=h.replace("S",d.separator);h=h.replace("D",d.delimiter);if(k.search(h)>-1){k=d.delimiter+k+d.delimiter}l.push(k)}e+=l.join(d.separator)+"\r\n"}if(!d.callback){return e}else{d.callback("",e)}},fromObjects:function(n,r,m){r=(r!==b?r:{});var h={};h.callback=((m!==b&&typeof(m)==="function")?m:false);h.separator="separator" in r?r.separator:a.csv.defaults.separator;h.delimiter="delimiter" in r?r.delimiter:a.csv.defaults.delimiter;h.headers="headers" in r?r.headers:a.csv.defaults.headers;h.sortOrder="sortOrder" in r?r.sortOrder:"declare";h.manualOrder="manualOrder" in r?r.manualOrder:[];h.transform=r.transform;if(typeof h.manualOrder==="string"){h.manualOrder=a.csv.toArray(h.manualOrder,h)}if(h.transform!==b){var d=n;n=[];var j;for(j=0;j<d.length;j++){n.push(h.transform.call(b,d[j]))}}var l=a.csv.helpers.collectPropertyNames(n);if(h.sortOrder==="alpha"){l.sort()}if(h.manualOrder.length>0){var f=[].concat(h.manualOrder);var c;for(c=0;c<l.length;c++){if(f.indexOf(l[c])<0){f.push(l[c])}}l=f}var e,c,q,g=[],k;if(h.headers){g.push(l)}for(e=0;e<n.length;e++){q=[];for(c=0;c<l.length;c++){k=l[c];if(k in n[e]&&typeof n[e][k]!=="function"){q.push(n[e][k])}else{q.push("")}}g.push(q)}return a.csv.fromArrays(g,r,h.callback)}};a.csvEntry2Array=a.csv.toArray;a.csv2Array=a.csv.toArrays;a.csv2Dictionary=a.csv.toObjects;if(typeof module!=="undefined"&&module.exports){module.exports=a.csv}}).call(this);